<!DOCTYPE html>
<html>
	<head>
		<title>Event Management</title>
		<!-- Include other necessary CSS/JS files here -->
		<!-- Example: Bootstrap CSS -->
		<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"> -->
	</head>
	<body>
		<div class="mb-5">
			<div class="row mb-5">
				<div class="col-2">
					<img
						src="{{doc.event_poster}}"
						class="img-fluid rounded-start"
						alt="{{doc.event_poster}}"
					/>
				</div>
				<div class="col-8">
					<h5>{{event_name}}</h5>
					<p>Penyelenggara : {{organizer}}</p>

					<div class="mb-3">
						{%- if category == 'Gratis' -%}
						<span class="badge badge-pill badge-success px-2 py-1">Gratis</span>
						{%- elif category == 'Berbayar' -%}
						<span class="badge badge-pill badge-info px-2 py-1">Rp. {{price}}</span>
						{%- endif -%}
					</div>

					<div class="mb-3">
						{%- if status == 'Terdaftar' -%}
						<b>Status Pendaftaran</b> :
						<span class="badge badge-pill badge-primary px-2 py-1"> Terdaftar</span>
						{%- elif status == 'Belum Terdaftar' -%}
						<b>Status Pendaftaran</b> :
						<span class="badge badge-pill badge-warning px-2 py-1">
							Belum Terdaftar</span
						>
						{%- endif -%}
					</div>

					<div class="d-flex">
						<p>
							<small class="text-body-secondary mr-5"
								><b>Tanggal Pelaksanaan</b> : {{date}}</small
							>
						</p>
						<p>
							<small class="text-body-secondary ml-5"
								><b>Kuota Peserta</b> : {{capacity}}</small
							>
						</p>
					</div>
				</div>
				<div class="col-2 d-flex justify-content-between align-items-center">
					{% if status == 'Belum Terdaftar' %}
					<a
						class="btn btn-primary px-5 py-2 register-event-btn"
						data-event="{{ doc.name }}"
						href="/events"
						>Daftar</a
					>
					{% endif %}
					<a
						name=""
						id=""
						class="btn btn-outline-primary border border-primary px-5 py-2"
						href="{{ doc.route }}"
						role="button"
						>Detail</a
					>
				</div>
			</div>
			<hr class="mb-5" />
		</div>

		<!-- Include the custom JavaScript file -->

		<!-- <script src="../events.js"></script> -->
		<script>
			function registerEvent(eventName) {
				//AJAX Request buat daftar event

				frappe.call({
					method: "my_app.events.register_event",
					args: {
						event_name: eventName,
					},
					callback: function (response) {
						// Respons dari server setelah pendaftaran
						if (response.message.status === "success") {
							// Update tampilan setelah pendaftaran berhasil
							document.querySelector(`[data-event="${eventName}"]`).textContent =
								"Terdaftar";
							document
								.querySelector(`[data-event="${eventName}"]`)
								.classList.remove("btn-primary");
							document
								.querySelector(`[data-event="${eventName}"]`)
								.classList.add("btn-secondary");
							document.querySelector(`[data-event="${eventName}"]`).disabled = true;
						} else {
							// Handle jika terjadi kesalahan
							alert("Gagal mendaftar pada acara ini.");
						}
					},
				});
			}
		</script>
	</body>
</html>
